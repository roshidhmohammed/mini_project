<form class="mb-5" action="/add-coupon" method="post">
    <!-- <div class="input-group"> -->
        <div class="form-outline flex-fill mb-0">
        <!-- <input type="text" class="form-control p-4" name="offer"  placeholder="Coupon Code"> -->
        <label class="form-label  select-label" for="form3Example1c">Coupon</label>
        <select name="offer"  style="background-color:whitesmoke;"class="form-control">
        <option value="" disabled selected>select coupon</option>
        <% if(offers){ %>
            <% for(let i=1;i <=offers.length; i++){ %>
                <option value="<%= offers[i-1].name %>">
                    <%= offers[i-1].name %>
                </option>
                <% } %>
                                                    <% }else{ %>
                                                        <h1>No Coupons to add</h1>
                                                        <% } %>
        </select>
        
        <div class="input-group-append">
            <button class="btn btn-primary" type="submit">Apply Coupon</button>
        </div>
    </div>
</form>



<!-- loadcart controller -->

const loadCart = async (req,res) =>{
    
    try {
        userSession = req.session
        if(userSession.userId) {            
            const userData = await User.findById({_id:userSession.userId})
            const completeUser = await userData.populate('cart.item.productId')
            // const offerData = await Offer.find()
            // if(userSession.couponTotal == 0) {
            //     userSession.couponTotal = userData.cart.totalPrice
            // }
            
            res.render('cart',{isLoggedin,id:userSession.userId,cartProducts:completeUser.cart,offers:offerData,offer:userSession.offer,couponTotal:userSession.couponTotal,user:userData})
        } else {
            res.render('cart',{isLoggedin,id:userSession.userId,offer:userSession.offer,couponTotal:userSession.couponTotal})
        }
         
    } catch (error) {
        console.log(error.message)
    }
}

<!-- cart.ejs-  -->

<div class="card-footer border-secondary bg-transparent">
    <div class="d-flex justify-content-between mt-2">
        <% if(offer) { %>
            <h5 class="font-weight-bold">Coupon</h5>
            <h5 class="font-weight-bold"><%= offer.name %></h5>
        <% } %>
    </div> 
    
        
    <div class="d-flex justify-content-between mt-2">
        <% if(id) { %>
        <h5 class="font-weight-bold">Total</h5>
        <h5 class="font-weight-bold" id="totall"><%= couponTotal %></h5>
        <% } %>
    </div>